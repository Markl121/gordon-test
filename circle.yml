machine:
  python:
    version: 2.7.6
  pre:
    # whitespace edit
    - sudo curl -L -o /usr/bin/docker 'http://s3-external-1.amazonaws.com/circle-downloads/docker-1.6.2-circleci' 
    - sudo chmod 0755 /usr/bin/docker
    - sudo sed -i -e 's/ --userland-proxy=false//' /etc/default/docker
    - sudo sed -i -e 's/exec "$DOCKER" daemon $DOCKER_OPTS/exec "$DOCKER" --daemon $DOCKER_OPTS/' /etc/init/docker.conf
  services:
    - docker
  environment:
    FOO: bar

dependencies:
  pre:
    - wget -O /tmp/selenium-server-standalone-2.45.0.jar "http://selenium-release.storage.googleapis.com/2.45/selenium-server-standalone-2.45.0.jar"
    - java -jar /tmp/selenium-server-standalone-2.45.0.jar:
        background: true
    - bash -c 'setsid python -m SimpleHTTPServer 8000 &':
        pwd: server-root
        background: true
#  post:
#    - sudo apt-get update; sudo apt-get install -y x11vnc
#    - x11vnc -forever -nopw:
#        background: true

test:
  pre:
    - ulimit -a
  post:
    - echo "hello" > ${CIRCLE_ARTIFACTS}/hello.txt
#  post:
#    - cat ~/.circlerc
#    - >
#      if [ -n "${RUN_NIGHTLY_BUILD}" ]; then
#        ./bin/run-integration-tests.sh ${INTEGRATION_TARGET};
#      fi

#deployment:
#  staging:
#    branch: master
#    heroku:
#      appname: quiet-depths-3134
